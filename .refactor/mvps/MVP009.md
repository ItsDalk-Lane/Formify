# MVP #009: 模板引擎

## 状态: pending

## 目标
实现 Handlebars 模板处理和变量替换。

## 功能边界
- [x] FormTemplateProcessEngine 核心类
- [x] Handlebars 模板解析
- [x] 内置变量支持：{{date}}, {{time}}, {{datetime}}
- [x] 字段变量替换：{{field_name}}
- [x] 剪贴板变量：{{clipboard}}
- [x] 选中文本变量：{{selection}}

## 不做
- 内链解析（单独 MVP）
- 复杂脚本执行

## 验收标准
1. 能正确解析 Handlebars 模板
2. 内置变量能正确替换
3. 字段变量能从 FormState 获取

## 依赖
- MVP005（数据模型）

## 参考代码
```typescript
// src/service/engine/FormTemplateProcessEngine.ts
import Handlebars from 'handlebars';
import { DateTime } from 'luxon';

export class FormTemplateProcessEngine {
  static process(text: string, state: FormState, app: App): string {
    // 注册内置 helpers
    const template = Handlebars.compile(text);
    const context = {
      ...state.values,
      date: DateTime.now().toFormat('yyyy-MM-dd'),
      time: DateTime.now().toFormat('HH:mm:ss'),
      datetime: DateTime.now().toFormat('yyyy-MM-dd HH:mm:ss'),
    };
    return template(context);
  }
}
```

## 预估时间
60-90 分钟
